# VnStock Screener Backend Configuration
# Copy this file to .env and customize as needed

# ===========================================
# Database
# ===========================================
DATABASE_PATH=./data/vnstock_data.db

# ===========================================
# VnStock Rate Limiting (IMPORTANT for 24/7)
# ===========================================
# Requests per minute - keep low to avoid API blocks
VNSTOCK_RATE_LIMIT=6

# Token bucket capacity (for bursts)
TOKEN_BUCKET_CAPACITY=6

# Token refill rate (tokens per second)
TOKEN_REFILL_RATE=0.1

# ===========================================
# Exponential Backoff
# ===========================================
# Initial delay after failure (seconds)
BACKOFF_BASE_DELAY=1.0

# Maximum delay (seconds) - 5 minutes
BACKOFF_MAX_DELAY=300.0

# Multiplier for each failure
BACKOFF_MULTIPLIER=2.0

# ===========================================
# Circuit Breaker
# ===========================================
# Failures before opening circuit
CIRCUIT_BREAKER_FAILURE_THRESHOLD=5

# Seconds before testing recovery
CIRCUIT_BREAKER_RECOVERY_TIMEOUT=300

# Test calls in half-open state
CIRCUIT_BREAKER_HALF_OPEN_MAX_CALLS=1

# ===========================================
# Update Schedule
# ===========================================
# Daily update time (after market close)
DAILY_UPDATE_TIME=18:00

# Weekly update day
WEEKLY_UPDATE_DAY=saturday

# Weekly update time
WEEKLY_UPDATE_TIME=20:00

# ===========================================
# Market Hours (Vietnam)
# ===========================================
MARKET_OPEN_HOUR=9
MARKET_CLOSE_HOUR=15

# ===========================================
# Data Collection
# ===========================================
# Default vnstock data source
DEFAULT_VNSTOCK_SOURCE=TCBS

# Batch size for bulk operations
BATCH_SIZE=10

# Maximum retries per operation
MAX_RETRIES=3

# Days of price history to keep
PRICE_HISTORY_DAYS=365

# ===========================================
# Logging
# ===========================================
LOG_LEVEL=INFO
LOG_FILE=logs/vnstock_updater.log
LOG_ROTATION=10 MB
LOG_RETENTION=7 days

# ===========================================
# Health Monitoring
# ===========================================
# Seconds between health checks
HEALTH_CHECK_INTERVAL=300

# Hours before data is considered stale
STALE_DATA_THRESHOLD_HOURS=24

# ===========================================
# API Server
# ===========================================
API_HOST=0.0.0.0
API_PORT=8000

# Allowed CORS origins (comma-separated)
CORS_ORIGINS=http://localhost:5173,http://localhost:3000
